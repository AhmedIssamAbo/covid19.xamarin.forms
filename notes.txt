Bug corrections and performances enhancements.